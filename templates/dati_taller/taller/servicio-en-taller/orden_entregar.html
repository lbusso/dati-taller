{% load crispy_forms_tags %}
<div class="modal-dialog modal-dialog-centered modal-" role="document">
        <div class="modal-content bg-light">
            <div class="modal-header">
                <h6 class="modal-title" id="modal-title-notification">Vamos a entregar esta orden!</h6>
                <button type="button" class="close" onclick="cerrar_modal()" aria-label="Close">
                    <span aria-hidden="true">Ã—</span>
                </button>
            </div>
            <div class="modal-body">

                <div class="py-3 text-center">
                    <i class="fa fa-clipboard-list fa-3x"></i>
                    <h4 class="heading mt-4">Entregar Orden!</h4>
                        <form method="post" action="{% url 'orden_entregar' orden.pk %}">{% csrf_token %}
                            <div class="form-group text-center">
                                <h2>Listo para entrgar esta orden?</h2>
                               <div style="display: none">{{ form | crispy }}</div>
                            </div>
                            <div class="modal-footer">
                            <button type="submit" id="btnentregar" class="btn btn-white">Si, Entregar!</button>
                            <button type="button" class="btn btn-link text-white ml-auto" onclick="cerrar_modal()">No! me olvide de algo.</button>
                            </div>
                        </form>
                </div>
            </div>
        </div>
</div>

<!-- <script>
    $(document).ready(function (){

        function reload(){
            var table = "{% url 'orden_list' %}";

            $.ajax({
               url: table,
               type: 'GET',
               reload,
            });
        }

        let cookie = document.cookie
        let csrfToken = cookie.substring(cookie.indexOf('=') + 1)


       $('#btnentregar').click(function (e){
           e.preventDefault();
          //alert('Funcionando');
           var pk = {{orden.pk}}
           var url = "{% url 'orden_entregar' orden.pk %}";
           var data = {"pk":pk};
           data = JSON.stringify(data);

           $.ajax({
               type: "POST",
               url: url,
               data: data,
              headers: {
           'X-CSRFToken': csrfToken
                },
               success: function (){

                Swal.fire({
                  position: 'top',
                  icon: 'success',
                  title: 'LA orden fue entregada!',
                  showConfirmButton: false,
                  timer: 1500
                });
                   cerrar_modal();
                   reload();
               },
               error: function (jqHXR, textStatus, errorThrow){
                   console.log(textStatus, errorThrow);
                   cerrar_modal();
               }
           });
       });
    });

</script> -->
